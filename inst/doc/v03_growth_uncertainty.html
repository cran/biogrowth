<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Including uncertainty in growth predictions in biogrowth</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Including uncertainty in growth predictions
in biogrowth</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(biogrowth)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>In most situations, growth predictions are surrounded by different
sources of uncertainty and variability. For this reason, discrete growth
predictions (i.e. growth curves) can be, in some cases, misleading.
Consequently, <strong>biogrowth</strong> includes several functions to
calculate growth predictions accounting for parameter uncertainty.
Namely, it can account for the uncertainty of parameter estimates of
primary growth models defined manually using
<code>predict_growth_uncertainty()</code>. Also, it can include the
uncertainty of a model fitted using a Monte Carlo algorithm with the
<code>predictMCMC()</code> method.</p>
<div id="growth-predictions-with-uncertainty-using-predict_growth_uncertainty" class="section level2">
<h2>Growth predictions with uncertainty using
<code>predict_growth_uncertainty()</code></h2>
<p>The function <code>predict_growth_uncertainty()</code> allows the
definition of the distribution of the parameters of the primary growth
model. Then, it includes this uncertainty in the model predictions
through Monte Carlo simulations. It has 8 arguments:</p>
<ul>
<li><code>model_name</code> defines the primary growth model,</li>
<li><code>times</code> defines the time points where to make the
calculations,</li>
<li><code>n_sims</code> defines the number of Monte Carlo
simulations,</li>
<li><code>pars</code> defines the distribution of the model
parameters,</li>
<li><code>corr_matrix</code> correlation matrix between the model
parameters. By default, this argument is set to an identity matrix
(i.e. no correlation between parameters).</li>
<li><code>check</code> states whether to do validity checks of the model
parameters (<code>TRUE</code> by default).</li>
<li><code>logbase_mu</code> defines the log-base used for the definition
of the growth rate (as in <code>predict_growth()</code>).</li>
<li><code>logbase_logN</code> defines the log-base used for the
definition of the log-microbial concentration (as in
<code>predict_growth()</code>).</li>
</ul>
<p>The calculations are done by taking a sample of size
<code>n_sims</code> of the model parameters according to a multivariate
normal distribution. For simulation, the population growth is predicted
and the quantiles of the predicted population size is used as an
estimate of the credible interval.</p>
<p>For this example, we will use the modified Gompertz model</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>my_model <span class="ot">&lt;-</span> <span class="st">&quot;modGompertz&quot;</span></span></code></pre></div>
<p>The <code>pars</code> argument defines the distribution of the model
parameters. It must be a tibble with 4 columns (<code>par</code>,
<code>mean</code>, <code>sd</code> and <code>scale</code>) and as many
rows as model parameters. Then, for the modified Gompertz model, we will
need 4 rows. The column <code>par</code> defines the parameter that is
defined on each row. It must be a parameter identifier according to
<code>primary_model_data()</code>. This function considers that each
model parameter follows a marginal normal distribution with the mean
defined in the <code>mean</code> column and the standard deviation
defined in <code>sd</code>. This distribution can be defined in
log-scale (by setting the value in <code>scale</code> to “log”),
square-root scale (“sqrt”) or in the original scale (“original”). Note
that, in order to omit the variability/uncertainty of any model
parameter, one just has to set its corresponding standard error to
zero.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    <span class="sc">~</span>par, <span class="sc">~</span>mean, <span class="sc">~</span>sd, <span class="sc">~</span>scale,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="st">&quot;logN0&quot;</span>, <span class="dv">0</span>, .<span class="dv">2</span>, <span class="st">&quot;original&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="st">&quot;mu&quot;</span>, <span class="dv">2</span>, .<span class="dv">3</span>, <span class="st">&quot;sqrt&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="st">&quot;lambda&quot;</span>, .<span class="dv">5</span>, .<span class="dv">1</span>, <span class="st">&quot;log&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="st">&quot;C&quot;</span>, <span class="dv">6</span>, .<span class="dv">5</span>, <span class="st">&quot;original&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    )</span></code></pre></div>
<p>For the time points, we will take 100 points uniformly distributed
between 0 and 15:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>my_times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="at">length =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>For the example, we will set the number of simulations to 1000.
Nevertheless, it is advisable to repeat the calculations for various
number of simulations to ensure convergence.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="dv">1000</span></span></code></pre></div>
<p>Once the arguments have been defined, we can call the
<code>predict_growth_uncertainty()</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>unc_growth <span class="ot">&lt;-</span> <span class="fu">predict_growth_uncertainty</span>(my_model, my_times, n_sims, pars)</span></code></pre></div>
<p>Before doing any calculations,
<code>predict_growth_uncertainty()</code> makes several consistency
checks of the model parameters (this can be turned off by passing
<code>check=FALSE</code>). It returns an instance of
<code>GrowthUncertainty</code> with the results of the simulation. It
implements several S3 methods to facilitate the interpretation of the
model simulations. The <code>print</code> method provides an overview of
the simulation setting.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">print</span>(unc_growth)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; Growth prediction based on primary models with uncertainty</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; Primary model: modGompertz </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Mean values of the model parameters:</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; [1] 0.0 2.0 0.5 6.0</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; Variance-covariance matrix:</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; [1,] 0.04 0.00 0.00 0.00</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; [2,] 0.00 0.09 0.00 0.00</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; [3,] 0.00 0.00 0.01 0.00</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; [4,] 0.00 0.00 0.00 0.25</span></span></code></pre></div>
<p>It also implements an S3 method for plot that can be used to
visualize the credible intervals</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(unc_growth)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In this plot, the solid line represents the mean of the simulations.
Then, the two shaded areas represent, respectively, the space between
the 10th and 90th, and the 5th and 95th quantiles.</p>
<p>The plot method includes additional arguments to edit the aesthetics
of the plot.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(unc_growth, <span class="at">ribbon80_fill =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">ribbon90_fill =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">alpha80 =</span> .<span class="dv">8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that <code>GrowthUncertainty</code> is a subclass of
<code>list</code>, making it easy to access several results of the
simulation. Namely, it includes the following items:</p>
<ul>
<li><code>sample</code>: sample of model parameters used for the
simulations</li>
<li><code>simulations</code>: results of the individual simulations</li>
<li><code>quantiles</code>: quantiles of the population size predicted
in the simulations</li>
<li><code>model</code>: model used for the simulations</li>
<li><code>mus</code>: expected values of the model parameters used for
the simulations.</li>
<li><code>sigma</code>: variance-covariance matrix used for the
simulations</li>
</ul>
<p>By default, the function considers that there is no correlation
between the model parameters. This can be varied by defining a
correlation matrix. Note that the rows and columns of this matrix are
defined in the the same order as in <code>pars</code>, and the
correlation is defined in the scale of <code>pars</code>. For instance,
we can define a correlation of -0.7 between the square root of <span class="math inline">\(\mu\)</span> and the logarithm of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>my_cor <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,   <span class="dv">0</span>,    <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                   <span class="dv">0</span>,   <span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.7</span>, <span class="dv">0</span>,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                   <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.7</span>,   <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                   <span class="dv">0</span>,    <span class="dv">0</span>,   <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                   <span class="at">nrow =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Then, we can include it in the call to the function</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>unc_growth2 <span class="ot">&lt;-</span> <span class="fu">predict_growth_uncertainty</span>(my_model, my_times, n_sims, pars, my_cor)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">plot</span>(unc_growth2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="accounting-for-the-uncertainty-of-a-fitted-model-using-predictmcmc" class="section level2">
<h2>Accounting for the uncertainty of a fitted model using
<code>predictMCMC()</code></h2>
<p>An alternative approach to account for uncertainty in model
predictions is to use the distribution of the model parameters estimated
from experimental data. In <strong>biogrowth</strong>, this can be done
using the <code>predictMCMC()</code> S3 method of <code>GrowthFit</code>
or <code>GlobalGrowthFit</code>. Note that this function is only
available for models fitted using an Adaptive Monte Carlo algorithm
(i.e., <code>algorithm=&quot;MCMC&quot;</code>). This function takes 5
arguments:</p>
<ul>
<li><code>model</code> the instance of <code>GrowthFit</code> or
<code>GlobalGrowthFit</code> to use for the calculations</li>
<li><code>times</code> a numeric vector stating the time points where
the solutions are calculated</li>
<li><code>env_conditions</code> a tibble (or data.frame) describing the
values of the environmental conditions</li>
<li><code>niter</code> the number of Monte Carlo simulations</li>
<li><code>newpars</code> a named list defining values for some model
parameters</li>
</ul>
<p>First, we need a model fitted using <code>fit_growth()</code>. In
this example, we will use a model fitted using
<code>approach=&quot;global&quot;</code>. Nonetheless, the calculations of the
predictions are exactly the same for a model fitted using
<code>approach=&quot;single&quot;</code>. Note that, in this case, the model is
fitted using an Adaptive Monte Carlo algorithm by setting
<code>algorithm=&quot;MCMC&quot;</code>. This uses <code>FME::modMCMC()</code>
instead of <code>FME::modFit()</code> for model fitting. We encourage
the reader to read in detail the documentation of this function and
references therein, as the interpretation of this fitting algorithm has
several differences with respect to regression.</p>
<p>The following code chunk fits the growth model using a global
approach. For a detailed description of the <code>fit_growth()</code>
function, the reader is referred to the vignette dedicated to model
fitting.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="do">## We will use the data included in the package</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;multiple_counts&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;multiple_conditions&quot;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="do">## We need to assign a model equation for each environmental factor</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>sec_models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">temperature =</span> <span class="st">&quot;CPM&quot;</span>, <span class="at">pH =</span> <span class="st">&quot;CPM&quot;</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="do">## Any model parameter (of the primary or secondary models) can be fixed</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>known_pars <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Nmax =</span> <span class="fl">1e8</span>, <span class="at">N0 =</span> <span class="fl">1e0</span>, <span class="at">Q0 =</span> <span class="fl">1e-3</span>,</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>                   <span class="at">temperature_n =</span> <span class="dv">2</span>, <span class="at">temperature_xmin =</span> <span class="dv">20</span>, </span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>                   <span class="at">temperature_xmax =</span> <span class="dv">35</span>,</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>                   <span class="at">pH_n =</span> <span class="dv">2</span>, <span class="at">pH_xmin =</span> <span class="fl">5.5</span>, <span class="at">pH_xmax =</span> <span class="fl">7.5</span>, <span class="at">pH_xopt =</span> <span class="fl">6.5</span>)</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>                   </span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="do">## The rest, need initial guesses</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>my_start <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mu_opt =</span> .<span class="dv">8</span>, <span class="at">temperature_xopt =</span> <span class="dv">30</span>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12421</span>)</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>global_MCMC <span class="ot">&lt;-</span> <span class="fu">fit_growth</span>(multiple_counts, </span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>                         sec_models, </span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>                         my_start, </span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>                         known_pars,</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>                         <span class="at">environment =</span> <span class="st">&quot;dynamic&quot;</span>,</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>                         <span class="at">algorithm =</span> <span class="st">&quot;MCMC&quot;</span>,</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>                         <span class="at">approach =</span> <span class="st">&quot;global&quot;</span>,</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>                         <span class="at">env_conditions =</span> multiple_conditions,</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>                         <span class="at">niter =</span> <span class="dv">100</span>,</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>                         <span class="at">lower =</span> <span class="fu">c</span>(.<span class="dv">2</span>, <span class="dv">29</span>),  <span class="co"># lower limits of the model parameters</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>                         <span class="at">upper =</span> <span class="fu">c</span>(.<span class="dv">8</span>, <span class="dv">34</span>)  <span class="co"># upper limits of the model parameters</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>                         ) </span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; number of accepted runs: 13 out of 100 (13%)</span></span></code></pre></div>
<p>Note that the number of iterations used in the model is too low for
convergence of the fitting algorithm. This can be visualized by
inspecting the trace plot of the Markov chain:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(global_MCMC<span class="sc">$</span>fit_results)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Therefore, this model should only be considered as an illustration of
the functions included in the package, not as a “serious” model. For
additional details on how to evaluate the convergence of this fitting
algorithm, the reader is referred to the documentation of
<strong>FME</strong> and references therein.</p>
<p>Once the model has been fitted, we can define the settings for the
simulation. The <code>predictMCMC()</code> method requires the
definition of the variation of the environmental conditions during the
simulation. This is defined as a tibble (or data.frame) with the same
conventions as for <code>fit_growth()</code>. Note that this argument
must defined the same environmental factors as the ones considered in
the original model. In this example, we will describe a constant
environmental profile where <code>temperature=30</code> and
<code>pH=7</code>. Note that this is just an example, and dynamic
profiles can also be calculated.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>my_conditions <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>),</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                        <span class="at">temperature =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">30</span>),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                        <span class="at">pH =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">7</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                        )</span></code></pre></div>
<p>Then, we need to define the time points where the solution is
calculated. We will use a uniformly distributed vector of length 50
between 0 and 40</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>my_times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">length =</span> <span class="dv">50</span>)</span></code></pre></div>
<p>The last argument we need to define is the number of Monte Carlo
simulations to use for the calculations. The calculations are performed
by taking a sample of size <code>niter</code> from the Markov chain of
the model parameters. Then, for each parameter vector, the functions
calculates the corresponding growth curve at each time point defined in
<code>times</code>. For this example we will use 50 Monte Carlo
simulations. This value is extremely low, and should only be used as an
illustration of the implementation of the function.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>niter <span class="ot">&lt;-</span> <span class="dv">50</span></span></code></pre></div>
<p>Once every argument has been defined, we can call the
<code>predictMCMC()</code> method</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>uncertain_prediction <span class="ot">&lt;-</span> <span class="fu">predictMCMC</span>(global_MCMC,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                                    my_times,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                                    my_conditions, </span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                                    <span class="at">niter =</span> niter</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                                    )</span></code></pre></div>
<p>The function returns an instance of <code>MCMCgrowth</code> with the
results of the simulation. It includes several S3 methods to facilitate
the interpretation of the results. The print method provides an overview
of the simulation settings.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">print</span>(uncertain_prediction)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; Growth prediction under dynamic conditions with parameter uncertainty</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; Environmental factors included: time, temperature, pH </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; Simulations based on the following model:</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; Growth model fitted to data following a global approach conditions using MCMC</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; Number of experiments: 2</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; Environmental factors included: temperature, pH </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; Secondary model for temperature: CPM</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; Secondary model for pH: CPM</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; Parameter estimates:</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt;           mu_opt temperature_xopt </span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt;        0.5095069       29.9829208 </span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; Fixed parameters:</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt;             Nmax               N0               Q0    temperature_n </span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt;          1.0e+08          1.0e+00          1.0e-03          2.0e+00 </span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; temperature_xmin temperature_xmax             pH_n          pH_xmin </span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt;          2.0e+01          3.5e+01          2.0e+00          5.5e+00 </span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt;          pH_xmax          pH_xopt </span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt;          7.5e+00          6.5e+00 </span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; Parameter mu defined in log-10 scale</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt; Population size defined in log-10 scale</span></span></code></pre></div>
<p>The <code>plot()</code> method illustrates the distribution of the
population size during the experiment.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">plot</span>(uncertain_prediction)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The solid line illustrates the median of the simulations for each
time point. Then, the ribbons show the space between the 10th and 90th,
and 5th and 95th percentiles of the simulations for each time point.</p>
<p><code>MCMCgrowth</code> is defined as a subclass of
<code>list</code>, so it is easy to access several aspects of the
simulations. Namely, it has 5 entries:</p>
<ul>
<li><code>sample</code> a tibble with the sample of model parameters
used for the simulations.</li>
<li><code>simulations</code> a tibble with the results of every
individual simulation used.</li>
<li><code>quantiles</code> a tibble providing the calculated quantiles
(5th, 10th, 50th, 90th, 95th) of the population size for each time
point.</li>
<li><code>model</code> the instance of <code>FitDynamicGrowthMCMC</code>
used for the predictions.</li>
<li><code>env_conditions</code> a tibble with the environmental
conditions of the simulations.</li>
</ul>
<p>As already mentioned, the <code>newpars</code> argument can be used
to define new values of the model parameters. As an illustration, we can
fix <code>mu_opt=0.5</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>uncertain_prediction2 <span class="ot">&lt;-</span> <span class="fu">predictMCMC</span>(global_MCMC,</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>                                    my_times,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                                    my_conditions, </span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                                    <span class="at">niter =</span> <span class="dv">5</span>,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                                    <span class="at">newpars =</span> <span class="fu">list</span>(<span class="at">mu_opt =</span> <span class="fl">0.5</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                                    )</span></code></pre></div>
<p>Inspecting the <code>sample</code> entry of the outcome shows that
the value of <code>mu_opt</code> is fixed to 0.5 for these simulations,
whereas <code>temperature_xopt</code> varies according to the fitted
model.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>uncertain_prediction2<span class="sc">$</span>sample</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 3</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt;   mu_opt temperature_xopt  iter</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;            &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; 1    0.5             29.3     1</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; 2    0.5             29.5     2</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; 3    0.5             29.5     3</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; 4    0.5             29.0     4</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; 5    0.5             29.3     5</span></span></code></pre></div>
</div>
<div id="accounting-for-uncertainty-when-calculating-the-time-to-reach-a-population-size" class="section level2">
<h2>Accounting for uncertainty when calculating the time to reach a
population size</h2>
<p>The <strong>biogrowth</strong> package includes the
<code>time_to_size()</code> function to estimate the elapsed time
required to reach a given population size for growth models. By default,
this function calculates a discrete value for the elapsed time.
Nevertheless, this can be modified passing
<code>type=distribution</code>. In this case, the function takes two
arguments:</p>
<ul>
<li><code>model</code> an instance of <code>GrowthUncertainty</code> or
<code>MCMCgrowth</code></li>
<li><code>size</code> the target population size (in log units)</li>
</ul>
<p>The distribution of the time to reach the given is estimated by
linear interpolation for each of the growth curves included in
<code>model</code>. Therefore, its precision is strongly dependent on
the number of simulations (i.e. the number of growth curves) and the
density of the time points around the solution. For that reason,
considering the low number of iterations and time points included in the
simulations, the results presented here should only be considered as an
illustration of the functions.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>unc_distrib <span class="ot">&lt;-</span> <span class="fu">time_to_size</span>(<span class="at">type =</span> <span class="st">&quot;distribution&quot;</span>, unc_growth, <span class="dv">3</span>)</span></code></pre></div>
<p>The function returns an instance of <code>TimeDistribution</code>
with the results of the calculation. It includes several S3 methods to
facilitate the interpretation of the results. The <code>print</code>
method provides an overall view of the results</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">print</span>(unc_distrib)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co">#&gt; Distribution of the time required to reach a target population size</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt;   m_time sd_time med_time   q10   q90</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; 1   4.04   0.848     3.94  3.03  5.15</span></span></code></pre></div>
<p>The <code>summary</code> method provides a table with several
statistical indexes of the distribution of the time.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">summary</span>(unc_distrib)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt;   m_time sd_time med_time   q10   q90</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">#&gt; 1   4.04   0.848     3.94  3.03  5.15</span></span></code></pre></div>
<p>The <code>plot</code> method shows an histogram of the distribution.
In this plot, the median of the simulations is shown as a dashed, red
line. The 10th and 90th percentiles are shown as grey, dashed lines.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">plot</span>(unc_distrib)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When interpreting the results of the calculation is important to
consider how <code>NA</code>s are considered by the function. It is
possible that, for some simulations, the target population size is not
included in the growth curve. In that case, that particular calculation
would results in a time of <code>NA</code>. This value is then omitted
when making the calculations (medians, quantiles, histograms…). This can
be relevant for population size in the edge of the simulations
(e.g. close to <code>logN0</code> or <code>logNmax</code>) and can
introduce a bias in the results.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
